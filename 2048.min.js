var game={data:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],isFull:function(){var a=this.data.toString();return a.indexOf("0")!=-1?false:true},randomNum:function(){if(!this.isFull()){while(true){var b=Math.floor(Math.random()*4);var a=Math.floor(Math.random()*4);if(this.data[b][a]==0){this.data[b][a]=Math.random()<0.5?2:4;break}}}},updateView:function(){for(var b=0;b<this.data.length;b++){for(var a=0;a<this.data[b].length;a++){var e="c"+b+a;var d=document.getElementById(e);var c=this.data[b][a];if(c!=0){d.innerHTML=c;d.className="cell n"+c}else{d.innerHTML="";d.className="cell"}}}},start:function(){this.data=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];this.randomNum();this.randomNum();this.updateView()},moveLeft:function(){if(this.canLeft()){for(var a=0;a<this.data.length;a++){this.moveLeftInRow(a)}this.randomNum();this.updateView()}},canLeft:function(){for(var c=0;c<this.data.length;c++){for(var a=1;a<this.data[c].length;a++){var d=this.data[c][a];var b=this.data[c][a-1];if(d!=0){if(b==0||d==b){return true}}}}return false},moveLeftInRow:function(b){for(var a=0;a<this.data[b].length-1;a++){var c=this.getNextRight(b,a);if(c==-1){break}else{if(this.data[b][a]==0){this.data[b][a]=this.data[b][c];this.data[b][c]=0}else{if(this.data[b][a]==this.data[b][c]){this.data[b][a]*=2;this.data[b][c]=0}}}}},getNextRight:function(c,a){for(var b=a+1;b<this.data[c].length;b++){if(this.data[c][b]!=0){return b}}return -1},moveRight:function(){if(this.canRight()){for(var a=0;a<this.data.length;a++){this.moveRightInRow(a)}this.randomNum();this.updateView()}},canRight:function(){for(var c=0;c<this.data.length;c++){for(var a=0;a<this.data[c].length-1;a++){var d=this.data[c][a];if(d!=0){var b=this.data[c][a+1];if(b==0||b==d){return true}}}}return false},moveRightInRow:function(b){for(var a=this.data[b].length-1;a>0;a--){var c=this.getNextLeft(b,a);if(c==-1){break}else{if(this.data[b][a]==0){this.data[b][a]=this.data[b][c];this.data[b][c]=0}else{if(this.data[b][a]==this.data[b][c]){this.data[b][a]*=2;this.data[b][c]=0}}}}},getNextLeft:function(c,a){for(var b=a-1;b>=0;b--){if(this.data[c][b]!=0){return b}}return -1},moveUp:function(){if(this.canUp){for(var a=0;a<this.data[0].length;a++){this.moveUpInCol(a)}this.randomNum();this.updateView()}},canUp:function(){for(var b=1;b<this.data.length;b++){for(var a=0;a<this.data[b].length;a++){if(this.data[b][a]!==0){if(this.data[b-1][a]==0||this.data[b-1][a]==this.data[b][a]){return true}}}}return false},moveUpInCol:function(a){for(var c=0;c<this.data.length-1;c++){var b=this.getNextDown(c,a);if(b==-1){break}else{if(this.data[c][a]==0){this.data[c][a]=this.data[b][a];this.data[b][a]=0;c--}else{if(this.data[b][a]==this.data[c][a]){this.data[c][a]*=2;this.data[b][a]=0}}}}},getNextDown:function(c,a){for(var b=c+1;b<this.data.length;b++){if(this.data[b][a]!=0){return b}}return -1},moveDown:function(){if(this.canDown()){for(var a=0;a<this.data[0].length;a++){this.moveDownInCol(a)}this.randomNum();this.updateView()}},canDown:function(){for(var c=0;c<this.data.length-1;c++){for(var a=0;a<this.data[c].length;a++){var d=this.data[c][a];if(d!=0){var b=this.data[c+1][a];if(b==0||b==d){return true}}}return false}},moveDownInCol:function(a){for(var c=this.data.length-1;c>0;c--){var b=this.getNextUp(c,a);if(b==-1){break}else{if(this.data[c][a]==0){this.data[c][a]=this.data[b][a];this.data[b][a]=0;c++}else{if(this.data[c][a]==this.data[b][a]){this.data[c][a]*=2;this.data[b][a]=0}}}}},getNextUp:function(c,a){for(var b=c-1;b>=0;b--){if(this.data[b][a]!=0){return b}}return -1}};